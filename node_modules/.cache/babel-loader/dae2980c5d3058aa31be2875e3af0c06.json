{"ast":null,"code":"import _objectSpread from\"/Users/johncoakley/development/projects/release_partner/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/johncoakley/development/projects/release_partner/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState}from'react';import{useDispatch,useSelector}from'react-redux';// material-ui\nimport{useTheme}from'@mui/material/styles';import{Box,ButtonBase,Collapse,IconButton,Link,Menu,MenuItem,Stack,Table,TableBody,TableCell,TableContainer,TableRow,Tooltip,Typography}from'@mui/material';// third-party\nimport{format}from'date-fns';import{Droppable,Draggable}from'react-beautiful-dnd';// project imports\nimport AddItem from'./AddItem';import EditStory from'./EditStory';import AlertStoryDelete from'./AlertStoryDelete';import Items from'./Items';import{SNACKBAR_OPEN,DELETE_STORY}from'store/actions';// assets\nimport MoreVertTwoToneIcon from'@mui/icons-material/MoreVertTwoTone';import AddCircleTwoToneIcon from'@mui/icons-material/AddCircleTwoTone';import KeyboardArrowDownIcon from'@mui/icons-material/KeyboardArrowDown';import KeyboardArrowRightIcon from'@mui/icons-material/KeyboardArrowRight';import MenuBookTwoToneIcon from'@mui/icons-material/MenuBookTwoTone';// drag wrapper\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var getDragWrapper=function getDragWrapper(isDragging,theme,open){return{backgroundColor:isDragging||open?theme.palette.primary.light:'transparent',userSelect:'none'};};// drop wrapper\nvar getDropWrapper=function getDropWrapper(isDraggingOver,theme){return{background:isDraggingOver?theme.palette.grey[100]+80:'transparent'};};// ==============================|| KANBAN BACKLOGS - USER STORY ||============================== //\nvar UserStory=function UserStory(_ref){var story=_ref.story,index=_ref.index;var theme=useTheme();var dispatch=useDispatch();var kanban=useSelector(function(state){return state.kanban;});var columns=kanban.columns,profiles=kanban.profiles;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),open=_useState2[0],setOpen=_useState2[1];var storyColumn=columns.filter(function(column){return column.id===story.columnId;})[0];var storyProfile=profiles.filter(function(profile){return profile.id===story.assign;})[0];// drawer\nvar _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),openDrawer=_useState4[0],setOpenDrawer=_useState4[1];var handleDrawerOpen=function handleDrawerOpen(){setOpenDrawer(function(prevState){return!prevState;});};var addItem=function addItem(){setOpenDrawer(function(prevState){return!prevState;});};var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),openStoryDrawer=_useState6[0],setOpenStoryDrawer=_useState6[1];var handleStoryDrawerOpen=function handleStoryDrawerOpen(){setOpenStoryDrawer(function(prevState){return!prevState;});};var editStory=function editStory(){setOpenStoryDrawer(function(prevState){return!prevState;});};var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),anchorEl=_useState8[0],setAnchorEl=_useState8[1];var handleClick=function handleClick(event){setAnchorEl(event===null||event===void 0?void 0:event.currentTarget);};var handleClose=function handleClose(){setAnchorEl(null);};var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),openModal=_useState10[0],setOpenModal=_useState10[1];var handleModalClose=function handleModalClose(status){setOpenModal(false);if(status){dispatch({type:DELETE_STORY,payload:{itemId:story.id}});dispatch({type:SNACKBAR_OPEN,open:true,message:'Task Deleted successfully',variant:'alert',anchorOrigin:{vertical:'top',horizontal:'right'},alertSeverity:'success'});}};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Draggable,{draggableId:story.id,index:index,children:function children(provided,snapshot){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(TableRow,_objectSpread(_objectSpread(_objectSpread({hover:true},provided.draggableProps),provided.dragHandleProps),{},{ref:provided.innerRef,sx:getDragWrapper(snapshot.isDragging,theme,open),children:[/*#__PURE__*/_jsx(TableCell,{sx:{pl:3,minWidth:120,width:120,height:46},children:/*#__PURE__*/_jsxs(Stack,{direction:\"row\",spacing:0.25,alignItems:\"center\",children:[/*#__PURE__*/_jsx(Tooltip,{title:\"Add Task\",children:/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"expand row\",size:\"small\",onClick:addItem,children:/*#__PURE__*/_jsx(AddCircleTwoToneIcon,{fontSize:\"small\",color:\"primary\"})})}),/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"expand row\",size:\"small\",onClick:function onClick(){return setOpen(!open);},children:open?/*#__PURE__*/_jsx(KeyboardArrowDownIcon,{fontSize:\"small\"}):/*#__PURE__*/_jsx(KeyboardArrowRightIcon,{fontSize:\"small\"})})]})}),/*#__PURE__*/_jsx(TableCell,{sx:{width:110,minWidth:110},children:/*#__PURE__*/_jsxs(Stack,{direction:\"row\",spacing:0.5,alignItems:\"center\",children:[/*#__PURE__*/_jsx(MenuBookTwoToneIcon,{color:\"secondary\",sx:{fontSize:'0.875rem'}}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:story.id})]})}),/*#__PURE__*/_jsx(TableCell,{sx:{maxWidth:'calc(100vw - 850px)',minWidth:140},component:\"th\",scope:\"row\",children:/*#__PURE__*/_jsx(Link,{underline:\"hover\",color:\"default\",onClick:editStory,sx:{overflow:'hidden',display:'block',textOverflow:'ellipsis',whiteSpace:'nowrap',':hover':{color:'primary.main'},cursor:'pointer'},children:story.title})}),/*#__PURE__*/_jsxs(TableCell,{sx:{width:60,minWidth:60},children:[/*#__PURE__*/_jsx(ButtonBase,{className:\"more-button\",sx:{borderRadius:'12px'},onClick:handleClick,\"aria-controls\":\"menu-comment\",\"aria-haspopup\":\"true\",children:/*#__PURE__*/_jsx(IconButton,{component:\"span\",size:\"small\",disableRipple:true,children:/*#__PURE__*/_jsx(MoreVertTwoToneIcon,{fontSize:\"inherit\"})})}),/*#__PURE__*/_jsxs(Menu,{id:\"menu-comment\",anchorEl:anchorEl,keepMounted:true,open:Boolean(anchorEl),onClose:handleClose,variant:\"selectedMenu\",anchorOrigin:{vertical:'bottom',horizontal:'right'},transformOrigin:{vertical:'top',horizontal:'right'},children:[/*#__PURE__*/_jsx(MenuItem,{onClick:function onClick(){handleClose();editStory();},children:\"Edit\"}),/*#__PURE__*/_jsx(MenuItem,{onClick:function onClick(){handleClose();setOpenModal(true);},children:\"Delete\"})]}),/*#__PURE__*/_jsx(AlertStoryDelete,{title:story.title,open:openModal,handleClose:handleModalClose})]}),/*#__PURE__*/_jsx(TableCell,{sx:{width:90,minWidth:90},children:storyColumn?storyColumn.title:''}),/*#__PURE__*/_jsx(TableCell,{sx:{width:140,minWidth:140},children:storyProfile?storyProfile.name:''}),/*#__PURE__*/_jsx(TableCell,{sx:{width:85,minWidth:85,textTransform:'capitalize'},children:story.priority}),/*#__PURE__*/_jsx(TableCell,{sx:{width:120,minWidth:120},children:story.dueDate?format(new Date(story.dueDate),'d MMM yyyy'):''})]})),/*#__PURE__*/_jsx(Droppable,{droppableId:story.id,type:\"item\",children:function children(providedDrop,snapshotDrop){var _story$itemIds;return/*#__PURE__*/_jsx(TableRow,_objectSpread(_objectSpread({ref:providedDrop.innerRef},providedDrop.droppableProps),{},{sx:getDropWrapper(snapshotDrop.isDraggingOver,theme),children:/*#__PURE__*/_jsx(TableCell,{style:{padding:0},colSpan:8,children:/*#__PURE__*/_jsx(Collapse,{in:open,timeout:\"auto\",unmountOnExit:true,children:/*#__PURE__*/_jsx(Box,{sx:{margin:0},children:/*#__PURE__*/_jsx(TableContainer,{children:/*#__PURE__*/_jsx(Table,{size:\"small\",\"aria-label\":\"purchases\",children:/*#__PURE__*/_jsxs(TableBody,{children:[(_story$itemIds=story.itemIds)===null||_story$itemIds===void 0?void 0:_story$itemIds.map(function(itemId,i){return/*#__PURE__*/_jsx(Items,{itemId:itemId,index:i},itemId);}),providedDrop.placeholder]})})})})})})}));}})]});}}),/*#__PURE__*/_jsx(EditStory,{story:story,open:openStoryDrawer,handleDrawerOpen:handleStoryDrawerOpen}),/*#__PURE__*/_jsx(AddItem,{open:openDrawer,handleDrawerOpen:handleDrawerOpen,storyId:story.id})]});};export default UserStory;","map":{"version":3,"sources":["/Users/johncoakley/development/projects/release_partner/src/views/application/kanban/Backlogs/UserStory.js"],"names":["useState","useDispatch","useSelector","useTheme","Box","ButtonBase","Collapse","IconButton","Link","Menu","MenuItem","Stack","Table","TableBody","TableCell","TableContainer","TableRow","Tooltip","Typography","format","Droppable","Draggable","AddItem","EditStory","AlertStoryDelete","Items","SNACKBAR_OPEN","DELETE_STORY","MoreVertTwoToneIcon","AddCircleTwoToneIcon","KeyboardArrowDownIcon","KeyboardArrowRightIcon","MenuBookTwoToneIcon","getDragWrapper","isDragging","theme","open","backgroundColor","palette","primary","light","userSelect","getDropWrapper","isDraggingOver","background","grey","UserStory","story","index","dispatch","kanban","state","columns","profiles","setOpen","storyColumn","filter","column","id","columnId","storyProfile","profile","assign","openDrawer","setOpenDrawer","handleDrawerOpen","prevState","addItem","openStoryDrawer","setOpenStoryDrawer","handleStoryDrawerOpen","editStory","anchorEl","setAnchorEl","handleClick","event","currentTarget","handleClose","openModal","setOpenModal","handleModalClose","status","type","payload","itemId","message","variant","anchorOrigin","vertical","horizontal","alertSeverity","provided","snapshot","draggableProps","dragHandleProps","innerRef","pl","minWidth","width","height","fontSize","maxWidth","overflow","display","textOverflow","whiteSpace","color","cursor","title","borderRadius","Boolean","name","textTransform","priority","dueDate","Date","providedDrop","snapshotDrop","droppableProps","padding","margin","itemIds","map","i","placeholder"],"mappings":"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","sourcesContent":["import PropTypes from 'prop-types';\r\nimport { useState } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\n\r\n// material-ui\r\nimport { useTheme } from '@mui/material/styles';\r\nimport {\r\n    Box,\r\n    ButtonBase,\r\n    Collapse,\r\n    IconButton,\r\n    Link,\r\n    Menu,\r\n    MenuItem,\r\n    Stack,\r\n    Table,\r\n    TableBody,\r\n    TableCell,\r\n    TableContainer,\r\n    TableRow,\r\n    Tooltip,\r\n    Typography\r\n} from '@mui/material';\r\n\r\n// third-party\r\nimport { format } from 'date-fns';\r\nimport { Droppable, Draggable } from 'react-beautiful-dnd';\r\n\r\n// project imports\r\nimport AddItem from './AddItem';\r\nimport EditStory from './EditStory';\r\nimport AlertStoryDelete from './AlertStoryDelete';\r\nimport Items from './Items';\r\nimport { SNACKBAR_OPEN, DELETE_STORY } from 'store/actions';\r\n\r\n// assets\r\nimport MoreVertTwoToneIcon from '@mui/icons-material/MoreVertTwoTone';\r\nimport AddCircleTwoToneIcon from '@mui/icons-material/AddCircleTwoTone';\r\nimport KeyboardArrowDownIcon from '@mui/icons-material/KeyboardArrowDown';\r\nimport KeyboardArrowRightIcon from '@mui/icons-material/KeyboardArrowRight';\r\nimport MenuBookTwoToneIcon from '@mui/icons-material/MenuBookTwoTone';\r\n\r\n// drag wrapper\r\nconst getDragWrapper = (isDragging, theme, open) => ({\r\n    backgroundColor: isDragging || open ? theme.palette.primary.light : 'transparent',\r\n    userSelect: 'none'\r\n});\r\n\r\n// drop wrapper\r\nconst getDropWrapper = (isDraggingOver, theme) => ({\r\n    background: isDraggingOver ? theme.palette.grey[100] + 80 : 'transparent'\r\n});\r\n\r\n// ==============================|| KANBAN BACKLOGS - USER STORY ||============================== //\r\n\r\nconst UserStory = ({ story, index }) => {\r\n    const theme = useTheme();\r\n    const dispatch = useDispatch();\r\n    const kanban = useSelector((state) => state.kanban);\r\n    const { columns, profiles } = kanban;\r\n    const [open, setOpen] = useState(false);\r\n\r\n    const storyColumn = columns.filter((column) => column.id === story.columnId)[0];\r\n    const storyProfile = profiles.filter((profile) => profile.id === story.assign)[0];\r\n\r\n    // drawer\r\n    const [openDrawer, setOpenDrawer] = useState(false);\r\n    const handleDrawerOpen = () => {\r\n        setOpenDrawer((prevState) => !prevState);\r\n    };\r\n\r\n    const addItem = () => {\r\n        setOpenDrawer((prevState) => !prevState);\r\n    };\r\n\r\n    const [openStoryDrawer, setOpenStoryDrawer] = useState(false);\r\n    const handleStoryDrawerOpen = () => {\r\n        setOpenStoryDrawer((prevState) => !prevState);\r\n    };\r\n\r\n    const editStory = () => {\r\n        setOpenStoryDrawer((prevState) => !prevState);\r\n    };\r\n\r\n    const [anchorEl, setAnchorEl] = useState(null);\r\n    const handleClick = (event) => {\r\n        setAnchorEl(event?.currentTarget);\r\n    };\r\n\r\n    const handleClose = () => {\r\n        setAnchorEl(null);\r\n    };\r\n\r\n    const [openModal, setOpenModal] = useState(false);\r\n\r\n    const handleModalClose = (status) => {\r\n        setOpenModal(false);\r\n        if (status) {\r\n            dispatch({\r\n                type: DELETE_STORY,\r\n                payload: {\r\n                    itemId: story.id\r\n                }\r\n            });\r\n\r\n            dispatch({\r\n                type: SNACKBAR_OPEN,\r\n                open: true,\r\n                message: 'Task Deleted successfully',\r\n                variant: 'alert',\r\n                anchorOrigin: { vertical: 'top', horizontal: 'right' },\r\n                alertSeverity: 'success'\r\n            });\r\n        }\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <Draggable draggableId={story.id} index={index}>\r\n                {(provided, snapshot) => (\r\n                    <>\r\n                        <TableRow\r\n                            hover\r\n                            {...provided.draggableProps}\r\n                            {...provided.dragHandleProps}\r\n                            ref={provided.innerRef}\r\n                            sx={getDragWrapper(snapshot.isDragging, theme, open)}\r\n                        >\r\n                            <TableCell sx={{ pl: 3, minWidth: 120, width: 120, height: 46 }}>\r\n                                <Stack direction=\"row\" spacing={0.25} alignItems=\"center\">\r\n                                    <Tooltip title=\"Add Task\">\r\n                                        <IconButton aria-label=\"expand row\" size=\"small\" onClick={addItem}>\r\n                                            <AddCircleTwoToneIcon fontSize=\"small\" color=\"primary\" />\r\n                                        </IconButton>\r\n                                    </Tooltip>\r\n                                    <IconButton aria-label=\"expand row\" size=\"small\" onClick={() => setOpen(!open)}>\r\n                                        {open ? <KeyboardArrowDownIcon fontSize=\"small\" /> : <KeyboardArrowRightIcon fontSize=\"small\" />}\r\n                                    </IconButton>\r\n                                </Stack>\r\n                            </TableCell>\r\n                            <TableCell sx={{ width: 110, minWidth: 110 }}>\r\n                                <Stack direction=\"row\" spacing={0.5} alignItems=\"center\">\r\n                                    <MenuBookTwoToneIcon color=\"secondary\" sx={{ fontSize: '0.875rem' }} />\r\n                                    <Typography variant=\"body2\">{story.id}</Typography>\r\n                                </Stack>\r\n                            </TableCell>\r\n                            <TableCell sx={{ maxWidth: 'calc(100vw - 850px)', minWidth: 140 }} component=\"th\" scope=\"row\">\r\n                                <Link\r\n                                    underline=\"hover\"\r\n                                    color=\"default\"\r\n                                    onClick={editStory}\r\n                                    sx={{\r\n                                        overflow: 'hidden',\r\n                                        display: 'block',\r\n                                        textOverflow: 'ellipsis',\r\n                                        whiteSpace: 'nowrap',\r\n                                        ':hover': { color: 'primary.main' },\r\n                                        cursor: 'pointer'\r\n                                    }}\r\n                                >\r\n                                    {story.title}\r\n                                </Link>\r\n                            </TableCell>\r\n                            <TableCell sx={{ width: 60, minWidth: 60 }}>\r\n                                <ButtonBase\r\n                                    className=\"more-button\"\r\n                                    sx={{ borderRadius: '12px' }}\r\n                                    onClick={handleClick}\r\n                                    aria-controls=\"menu-comment\"\r\n                                    aria-haspopup=\"true\"\r\n                                >\r\n                                    <IconButton component=\"span\" size=\"small\" disableRipple>\r\n                                        <MoreVertTwoToneIcon fontSize=\"inherit\" />\r\n                                    </IconButton>\r\n                                </ButtonBase>\r\n                                <Menu\r\n                                    id=\"menu-comment\"\r\n                                    anchorEl={anchorEl}\r\n                                    keepMounted\r\n                                    open={Boolean(anchorEl)}\r\n                                    onClose={handleClose}\r\n                                    variant=\"selectedMenu\"\r\n                                    anchorOrigin={{\r\n                                        vertical: 'bottom',\r\n                                        horizontal: 'right'\r\n                                    }}\r\n                                    transformOrigin={{\r\n                                        vertical: 'top',\r\n                                        horizontal: 'right'\r\n                                    }}\r\n                                >\r\n                                    <MenuItem\r\n                                        onClick={() => {\r\n                                            handleClose();\r\n                                            editStory();\r\n                                        }}\r\n                                    >\r\n                                        Edit\r\n                                    </MenuItem>\r\n                                    <MenuItem\r\n                                        onClick={() => {\r\n                                            handleClose();\r\n                                            setOpenModal(true);\r\n                                        }}\r\n                                    >\r\n                                        Delete\r\n                                    </MenuItem>\r\n                                </Menu>\r\n                                <AlertStoryDelete title={story.title} open={openModal} handleClose={handleModalClose} />\r\n                            </TableCell>\r\n                            <TableCell sx={{ width: 90, minWidth: 90 }}>{storyColumn ? storyColumn.title : ''}</TableCell>\r\n                            <TableCell sx={{ width: 140, minWidth: 140 }}>{storyProfile ? storyProfile.name : ''}</TableCell>\r\n                            <TableCell sx={{ width: 85, minWidth: 85, textTransform: 'capitalize' }}>{story.priority}</TableCell>\r\n                            <TableCell sx={{ width: 120, minWidth: 120 }}>\r\n                                {story.dueDate ? format(new Date(story.dueDate), 'd MMM yyyy') : ''}\r\n                            </TableCell>\r\n                        </TableRow>\r\n\r\n                        <Droppable droppableId={story.id} type=\"item\">\r\n                            {(providedDrop, snapshotDrop) => (\r\n                                <TableRow\r\n                                    ref={providedDrop.innerRef}\r\n                                    {...providedDrop.droppableProps}\r\n                                    sx={getDropWrapper(snapshotDrop.isDraggingOver, theme)}\r\n                                >\r\n                                    <TableCell style={{ padding: 0 }} colSpan={8}>\r\n                                        <Collapse in={open} timeout=\"auto\" unmountOnExit>\r\n                                            <Box\r\n                                                sx={{\r\n                                                    margin: 0\r\n                                                }}\r\n                                            >\r\n                                                <TableContainer>\r\n                                                    <Table size=\"small\" aria-label=\"purchases\">\r\n                                                        <TableBody>\r\n                                                            {story.itemIds?.map((itemId, i) => (\r\n                                                                <Items key={itemId} itemId={itemId} index={i} />\r\n                                                            ))}\r\n                                                            {providedDrop.placeholder}\r\n                                                        </TableBody>\r\n                                                    </Table>\r\n                                                </TableContainer>\r\n                                            </Box>\r\n                                        </Collapse>\r\n                                    </TableCell>\r\n                                </TableRow>\r\n                            )}\r\n                        </Droppable>\r\n                    </>\r\n                )}\r\n            </Draggable>\r\n            <EditStory story={story} open={openStoryDrawer} handleDrawerOpen={handleStoryDrawerOpen} />\r\n            <AddItem open={openDrawer} handleDrawerOpen={handleDrawerOpen} storyId={story.id} />\r\n        </>\r\n    );\r\n};\r\n\r\nUserStory.propTypes = {\r\n    index: PropTypes.number,\r\n    story: PropTypes.object\r\n};\r\n\r\nexport default UserStory;\r\n"]},"metadata":{},"sourceType":"module"}